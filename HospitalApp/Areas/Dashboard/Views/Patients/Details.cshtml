@model HospitalApp.Models.Patient
@{
    Layout = "~/Areas/Dashboard/Views/Shared/_DashboardLayout.cshtml";
    ViewData["Title"] = "Chi tiết bệnh nhân";
    string displayName = string.IsNullOrWhiteSpace(Model.FullName)
        ? (Model.User?.UserName ?? Model.User?.Email ?? "(Chưa có)")
        : Model.FullName!;
}

<h2 class="mb-3">@ViewData["Title"]</h2>

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}
@if (TempData["Msg"] != null)
{
    <div class="alert alert-success">@TempData["Msg"]</div>
}

<div class="card shadow-sm">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3 col-md-2">ID</dt>
            <dd class="col-sm-9 col-md-10">@Model.Id</dd>

            <dt class="col-sm-3 col-md-2">Họ tên</dt>
            <dd class="col-sm-9 col-md-10">@displayName</dd>

            <dt class="col-sm-3 col-md-2">Ngày sinh</dt>
            <dd class="col-sm-9 col-md-10">@Model.DateOfBirth?.ToString("dd/MM/yyyy")</dd>

            <dt class="col-sm-3 col-md-2">Dân tộc</dt>
            <dd class="col-sm-9 col-md-10">@(!string.IsNullOrWhiteSpace(Model.Ethnic) ? Model.Ethnic : "-")</dd>

            <dt class="col-sm-3 col-md-2">Tài khoản</dt>
            <dd class="col-sm-9 col-md-10">
                @if (!string.IsNullOrEmpty(Model.UserId))
                {
                    <span class="badge bg-success me-2">Đã liên kết</span>
                    <span>@(Model.User?.UserName ?? Model.User?.Email ?? "-")</span>
                }
                else
                {
                    <span class="badge bg-secondary">Khách</span>
                }
            </dd>
        </dl>
    </div>
</div>

<div class="mt-3 d-flex gap-2">
    <a class="btn btn-primary" asp-action="Edit" asp-route-id="@Model.Id">
        <i class="fas fa-edit"></i> Sửa
    </a>
    <a class="btn btn-outline-danger" asp-action="Delete" asp-route-id="@Model.Id">
        <i class="fas fa-trash-alt"></i> Xoá
    </a>
    <a class="btn btn-secondary" asp-action="Index">
        <i class="fas fa-list"></i> Về danh sách
    </a>
</div>
