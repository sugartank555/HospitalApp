@{
    ViewData["Title"] = "Đặt lịch khám";
    var doctors = (IEnumerable<HospitalApp.Models.Doctor>)ViewBag.Doctors;
    string patientName = (string)(ViewBag.PatientName ?? "");
    string selectedTime = (string)(ViewBag.TimeFrame ?? "");

    // Khung giờ mẫu – sửa tùy lịch phòng khám của bạn
    string[] morning = { "08:00-08:30", "08:30-09:00", "09:00-09:30", "09:30-10:00", "10:00-10:30", "10:30-11:00" };
    string[] afternoon = { "13:30-14:00", "14:00-14:30", "14:30-15:00", "15:00-15:30", "15:30-16:00" };
}
<h2>@ViewData["Title"]</h2>

<form method="post" class="row g-3">
    @Html.AntiForgeryToken()

    <div class="col-md-5">
        <label class="form-label">Tên bệnh nhân</label>
        <input name="patientName" class="form-control" value="@patientName" placeholder="Ví dụ: Nguyễn Văn A" />
        <div class="form-text">Để trống nếu dùng tên trong hồ sơ hiện tại.</div>
    </div>

    <div class="col-md-3">
        <label class="form-label">Ngày khám</label>
        <input type="date" name="date" class="form-control" value="@(ViewBag.Date ?? "")" required />
    </div>

    <div class="col-md-3">
        <label class="form-label">Khung giờ</label>
        <select name="timeFrame" class="form-select" required>
            <option value="">— Chọn khung giờ —</option>
            <optgroup label="Buổi sáng">
                @foreach (var s in morning)
                {
                    <option value="@s" selected="@(string.Equals(selectedTime, s, StringComparison.OrdinalIgnoreCase))">@s</option>
                }
            </optgroup>
            <optgroup label="Buổi chiều">
                @foreach (var s in afternoon)
                {
                    <option value="@s" selected="@(string.Equals(selectedTime, s, StringComparison.OrdinalIgnoreCase))">@s</option>
                }
            </optgroup>
        </select>
       
    </div>

    <div class="col-md-6">
        <label class="form-label">Bác sĩ</label>
        <select name="doctorId" class="form-select" required>
            @foreach (var d in doctors)
            {
                var sel = (int?)ViewBag.SelectedDoctorId == d.Id ? "selected" : null;
                <option value="@d.Id" selected="@sel">@d.FullName</option>
            }
        </select>
    </div>

    <div class="col-12">
        <button class="btn btn-primary">Gửi yêu cầu</button>
        <a asp-controller="Appointments" asp-action="My" class="btn btn-outline-secondary">Lịch của tôi</a>
    </div>
</form>
